
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Answers: Lab Week 4 &#8212; EOSC211 - Computer Methods for Earth, Ocean, and Atmospheric Scientists</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Logic" href="../../wk05/logic.html" />
    <link rel="prev" title="Making Plots Worksheet" href="../../wk04/making_plots.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      <h1 class="site-logo" id="site-title">EOSC211 - Computer Methods for Earth, Ocean, and Atmospheric Scientists</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../announcements.html">
   Course Home/Announcements
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 1 - Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus/syllabus.html">
   Course Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus/covid_statements.html">
   Covid Safety in the Classroom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus/schedule_F2021.html">
   Course Schedule - Fall Semester 2021
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus/worksheet_steps_in_problem_solving.html">
   Steps In Problem Solving
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 2 - Data Types
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk02/data_types.html">
   Data Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk02/some_review_plus_built_in_functions_arrays_preview.html">
   Some Review Plus Built-In Functions, Arrays Preview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week2_lab/lab_wk2.html">
   Answers: Lab Week 2 - Jupyterhub Tutorial
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk02/week2_quiz.html">
   Week 2 quiz
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 3 - Data Structures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk03/data_structures.html">
   Data Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk03/data_structures_ii.html">
   Data Structures II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk03/week3_quiz.html">
   Week 3 quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week3_lab/lab_wk3_soln.html">
   Answers: Lab Week 3
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 4 - Scientific Figures
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk04/making_plots.html">
   Making Plots Worksheet
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Answers: Lab Week 4
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 5 - Computer Logic
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk05/logic.html">
   Logic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk05/complicated_logic.html">
   More Complicated Logic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk05/wk05_indexing.html">
   Indexing worksheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk05/week5_quiz.html">
   Week 5 quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week5_lab/lab_wk5.html">
   Answers: Lab Week 5
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 6 - Loops
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk06/loops.html">
   Loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk06/loops_ii.html">
   Loops II
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Reference material
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../reference_notes/thursday_oct7.html">
   Notes for Thursday Oct. 7
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../../_sources/lab_keys/week4_lab/lab_wk4.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/lab_keys/week4_lab/lab_wk4.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/phaustin/eosc211_students/e211_live_main?urlpath=tree/lab_keys/week4_lab/lab_wk4.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://eosc211.jupyterhub.eoas.ubc.ca/jupyter/hub/user-redirect/git-pull?repo=https://github.com/phaustin/eosc211_students&urlpath=tree/eosc211_students/lab_keys/week4_lab/lab_wk4.md&branch=e211_live_main"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eosc-211">
   EOSC 211
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#learning-objectives">
     Learning Objectives:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-1-computer-math-and-writing-stylish-code-tutorial">
   Part 1: Computer Math and Writing Stylish Code (Tutorial)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tips-on-writing-code-with-style">
     Tips on Writing Code With Style:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coding-up-the-hydrostatic-equations">
     “Coding Up” the Hydrostatic Equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#math-with-arrays">
     Math with Arrays
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-plt-subplots-method">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       plt.subplots()
      </span>
     </code>
     Method
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-2-clausius-clapeyron-equation-and-the-atmospheric-equation-of-state">
   Part 2: Clausius-Clapeyron Equation and the Atmospheric Equation of State
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#your-task-implementing-the-clausius-clapeyron-equation-in-python">
     Your Task: Implementing the Clausius-Clapeyron Equation in Python
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="answers-lab-week-4">
<h1>Answers: Lab Week 4<a class="headerlink" href="#answers-lab-week-4" title="Permalink to this headline">¶</a></h1>
<div class="section" id="eosc-211">
<h2>EOSC 211<a class="headerlink" href="#eosc-211" title="Permalink to this headline">¶</a></h2>
<div class="section" id="learning-objectives">
<h3>Learning Objectives:<a class="headerlink" href="#learning-objectives" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Do math with python!</p></li>
<li><p>Write structured code following input-process-output procedure</p></li>
<li><p>Develop code with the scaffolding technique</p></li>
<li><p>More plots!</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span> 
<span class="kn">import</span> <span class="nn">numpy.testing</span> <span class="k">as</span> <span class="nn">testing</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="part-1-computer-math-and-writing-stylish-code-tutorial">
<h2>Part 1: Computer Math and Writing Stylish Code (Tutorial)<a class="headerlink" href="#part-1-computer-math-and-writing-stylish-code-tutorial" title="Permalink to this headline">¶</a></h2>
<p>Below are the hydrostatic equations. They relate <em>atmospheric pressure</em> and <em>density</em> to height above sea level. The pressure and air density conditions we measure at the surface are due to the weight of the atmosphere above being pulled down by Earth’s gravity. As we move higher into the atmosphere, there is less air above us (less weight pushing down), so the pressure decreases, as does the density (less pressure = less force squeezing the air molecules together). For air pressure <span class="math notranslate nohighlight">\(P\)</span>, we can express this as a mathematical function:</p>
<div class="math notranslate nohighlight">
\[
P = P_0\cdot e^{-(a_P/T)\cdot z}\tag{Stull 1.9a†}
\]</div>
<p>similarly for density <span class="math notranslate nohighlight">\(\rho\)</span> (represented by the greek letter <em>rho</em>):</p>
<div class="math notranslate nohighlight">
\[
\rho = \rho_0\cdot e^{-(a_\rho/T)\cdot z}\tag{Stull 1.13a†}
\]</div>
<p>where <span class="math notranslate nohighlight">\(a_P=0.0342 K/m\)</span> and <span class="math notranslate nohighlight">\(a_\rho=0.040K/m\)</span> are constants. The average value for pressure and air density at sea level are <span class="math notranslate nohighlight">\(P_0=101325 Pa\)</span>, and <span class="math notranslate nohighlight">\(\rho_0=1.225kg/m^3\)</span>, respectively.</p>
<p>Lets define our variables in a table:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Symbol</p></th>
<th class="text-align:left head"><p>Variable</p></th>
<th class="text-align:left head"><p>SI Units</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(P\)</span></p></td>
<td class="text-align:left"><p>Pressure</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(\rho\)</span></p></td>
<td class="text-align:left"><p>Density</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(kg/m^3\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(T\)</span></p></td>
<td class="text-align:left"><p>Temperature</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(K\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(z\)</span></p></td>
<td class="text-align:left"><p>Height Above Sea Level</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
</tbody>
</table>
<p>We would like to write code to calculate atmospheric pressure and density at any given height. In lecture, we practiced using Python’s built in mathematical operators <code class="docutils literal notranslate"><span class="pre">+</span> <span class="pre">=</span> <span class="pre">*</span> <span class="pre">/</span> <span class="pre">**</span></code>. Now we will apply these skills to <em>mathematically describe the state of the atmosphere</em> and make some informative graphics to communicate our results. As always when tackling a more complex problem, keeping our code organized is incredibly helpful, especially when we need to circle back to either modify or debug our program.</p>
<hr class="docutils" />
<div class="section" id="tips-on-writing-code-with-style">
<h3>Tips on Writing Code With Style:<a class="headerlink" href="#tips-on-writing-code-with-style" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Be very careful with unit conversion.  Humans usually like to express temperature in Celsius, but the thermodynamic equations require temperatures in Kelvin.  That means that you need to distinguish between two temperatures with names like <code class="docutils literal notranslate"><span class="pre">Tk</span></code> and <code class="docutils literal notranslate"><span class="pre">Tc</span></code>, where <code class="docutils literal notranslate"><span class="pre">Tk</span> <span class="pre">=</span> <span class="pre">Tc</span> <span class="pre">+</span> <span class="pre">273.15</span></code>. Make sure that you convert to Kelvin as soon as you can. Do it only once at the start and (if necessary for output) once at the end.</p></li>
<li><p>Choose good variable names. Don’t use single letters like <code class="docutils literal notranslate"><span class="pre">T</span></code> and <code class="docutils literal notranslate"><span class="pre">P</span></code> for variable names in a script. It makes it very hard to do search and replace with your editor when you want to change them, and the names aren’t very meaningful to others who might read your code. Remember that Python is <em>case sensitive</em> so <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">p</span></code> are two different variables. Also, it is super helpful to note the units of each variable with comments.</p></li>
<li><p>As much as you can, separate your script into 4 parts IN THIS ORDER:</p></li>
</ul>
<blockquote>
<div><p><strong>1.  INPUTS:</strong>  These  are  variables  whose  values  you  might  want  to  change  if  you  run  the  program multiple times.</p>
</div></blockquote>
<blockquote>
<div><p><strong>2.  INTERNAL DEFINITIONS or CONSTANTS:</strong> These are variables that are defined as constants which you will never change, or some simple conversions (e.g. Celsius to Kelvin)</p>
</div></blockquote>
<blockquote>
<div><p><strong>3.  CALCULATIONS:</strong> This is where the complicated parts of the procedure go</p>
</div></blockquote>
<blockquote>
<div><p><strong>4.  OUTPUTS:</strong> What you do once the math is finished (e.g. plotting).</p>
</div></blockquote>
<ul class="simple">
<li><p>It is useful to separate the parts by white space, and liberally comment your code. You can also separate each of these four parts into individual cells in a Jupyter Notebook, so you can run them individually, one at a time. Note that not all tasks in 2 and 3 are easily separated, and sometimes plotting happens earlier than the end of the program, but it’s a good idea to always approach problems this way initially.</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="coding-up-the-hydrostatic-equations">
<h3>“Coding Up” the Hydrostatic Equations<a class="headerlink" href="#coding-up-the-hydrostatic-equations" title="Permalink to this headline">¶</a></h3>
<p>Write python code to solve for pressure and density:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># inputs</span>
<span class="n">Tc</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># temperature in Celcius [C]</span>
<span class="n">height</span> <span class="o">=</span> <span class="mi">8849</span>  <span class="c1"># [m]</span>

<span class="c1"># internal definitions</span>
<span class="n">Tk</span> <span class="o">=</span> <span class="n">Tc</span> <span class="o">+</span> <span class="mf">273.15</span>  <span class="c1"># temperature in Kelvin [K]</span>
<span class="n">a_P</span> <span class="o">=</span> <span class="mf">0.0342</span>  <span class="c1"># [K/m]</span>
<span class="n">a_rho</span> <span class="o">=</span> <span class="mf">0.040</span>  <span class="c1"># [K/m]</span>
<span class="n">P0</span> <span class="o">=</span> <span class="mi">101325</span>  <span class="c1"># surface pressure in Pascals [Pa]</span>
<span class="n">rho_0</span> <span class="o">=</span> <span class="mf">1.225</span>  <span class="c1"># density at z=0 [kg/m3]</span>

<span class="c1"># calculations</span>
<span class="n">pres</span> <span class="o">=</span> <span class="n">P0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a_P</span> <span class="o">/</span> <span class="n">Tk</span> <span class="o">*</span> <span class="n">height</span><span class="p">)</span>  <span class="c1"># eq 1.9a</span>
<span class="n">dens</span> <span class="o">=</span> <span class="n">rho_0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a_rho</span> <span class="o">/</span> <span class="n">Tk</span> <span class="o">*</span> <span class="n">height</span><span class="p">)</span>  <span class="c1"># eq 1.13a</span>

<span class="c1"># outputs</span>
<span class="c1"># print the result rounded to two decimal places: </span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pressure at </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s1">m is </span><span class="si">{</span><span class="n">pres</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Pa&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Density is </span><span class="si">{</span><span class="n">dens</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kg/m3&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pressure at 8849m is 36088.53 Pa
Density is 0.37 kg/m3
</pre></div>
</div>
</div>
</div>
<p>Try playing with the inputs to see if our pressure/density calculator is working properly. We know that at the surface (ie <span class="math notranslate nohighlight">\(z\)</span>=0m), the pressure should equal the reference <span class="math notranslate nohighlight">\(P_0\)</span> of 101325 Pa. On the summit of Mt Everest (8849m), pressure is roughly a third of that value. Waaay up high, (try setting <span class="math notranslate nohighlight">\(z\)</span> to a billion or something) the pressure should drop away to near 0 Pa. Is our calculation working properly? <em>It is <strong>always</strong> good practice to do some “common sense” checks like these wherever you can in writing code - they will save you a lot of time debugging later.</em></p>
</div>
<hr class="docutils" />
<div class="section" id="math-with-arrays">
<h3>Math with Arrays<a class="headerlink" href="#math-with-arrays" title="Permalink to this headline">¶</a></h3>
<p>Now that you have working code for <em>scalar inputs</em> (and checked that it calculates the correct values), let’s can apply it to a whole range of values by defining our inputs as numpy arrays instead of single variables (we could also use lists, tuples or most any <em>iterable data type</em> will work). Solving this equation by hand or with a calculator isn’t that hard, but now we can solve it again and again as many times as we want for no extra cost! Let’s compute the pressure for a bunch of different heights, then use Matplotlib to make an XY plot of our output variables over the specified range of inputs.</p>
<p><strong>Remember:</strong> Multiplying an array <code class="docutils literal notranslate"><span class="pre">A</span></code> by a scalar variable <code class="docutils literal notranslate"><span class="pre">b</span></code> multiplies every element of <code class="docutils literal notranslate"><span class="pre">A</span></code> by <code class="docutils literal notranslate"><span class="pre">b</span></code>. Multiplying an array <code class="docutils literal notranslate"><span class="pre">A</span></code> by another array <code class="docutils literal notranslate"><span class="pre">B</span></code> does the operation <em>element-wise</em>; i.e. the first element of <code class="docutils literal notranslate"><span class="pre">A</span></code> gets multiplied by the first element of <code class="docutils literal notranslate"><span class="pre">B</span></code>, the second element of <code class="docutils literal notranslate"><span class="pre">A</span></code> by the second of <code class="docutils literal notranslate"><span class="pre">B</span></code>, etc. This only works if the <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> are the same size and shape.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># change the &quot;height&quot; input to an array</span>
<span class="n">height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># m</span>

<span class="c1"># this cell &quot;knows&quot; about the definitions from the previous cell, no need to repeat</span>
<span class="c1"># (unless we want to change something)</span>

<span class="c1"># calculations</span>
<span class="n">pres</span> <span class="o">=</span> <span class="n">P0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a_P</span> <span class="o">/</span> <span class="n">Tk</span> <span class="o">*</span> <span class="n">height</span><span class="p">)</span>  <span class="c1"># eq 1.9a</span>
<span class="n">dens</span> <span class="o">=</span> <span class="n">rho_0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a_rho</span> <span class="o">/</span> <span class="n">Tk</span> <span class="o">*</span> <span class="n">height</span><span class="p">)</span>  <span class="c1"># eq 1.13a</span>

<span class="c1"># output</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pressure: </span><span class="si">{</span><span class="n">pres</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Density: </span><span class="si">{</span><span class="n">dens</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pressure: [31553.82862659 35458.3495896  39846.02218947 44776.63237856
 50317.36411808 56543.71481951 63540.52406416 71403.12961813
 80238.66649441 90167.52676294]
Density: [0.31300118 0.3587608  0.41121031 0.47132775 0.54023413 0.61921438
 0.70974124 0.8135028  0.93243392 1.06875234]
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="the-plt-subplots-method">
<h3>The <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code> Method<a class="headerlink" href="#the-plt-subplots-method" title="Permalink to this headline">¶</a></h3>
<p>The outputs from the previous cell don’t exactly jump off the page. We could show our results much better with, you guessed it: <em>a scientific figure!</em> Unlike last week, we have 2 separate but related datasets, and ideally we would like to present them together as one figure. For this we can use a slightly different plotting syntax, which creates one big “figure” object, and “axes” objects which are displayed on the figure. We can create the axes individually, referencing them using <em>slicing</em> to mess around with their content, labels, colours etc. just like the plot we created last week. The syntax for creating subplots is as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the figure with one row and two columns of plots, and</span>
<span class="c1"># also specify the two subplots to share the same y-axis.</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># use slicing to assign what to plot where</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pres</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dens</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Pressure and Density Variation with Altitude&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>  <span class="c1"># title for the whole figure</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Pressure (Pa)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Height (m)&quot;</span><span class="p">)</span>  <span class="c1"># because sharey=True, we only need this once</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Density (kg/m3)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lab_wk4_8_0.png" src="../../_images/lab_wk4_8_0.png" />
</div>
</div>
<p>Do we check all the boxes?</p>
<div class="alert alert-block alert-info">
<b>Scientific Figure Checklist:</b> 
<ul class="simple">
<li><p>[ ] Title (Short and sweet is best)</p></li>
<li><p>[ ] Axes labels with units (Don’t forget the units!)</p></li>
<li><p>[ ] Legend (Or anything that helps interpret the information presented)</p></li>
<li><p>[ ] Does the figure <em>make sense</em> just by looking at it? The data should be clear without referencing anything outside the figure</p></li>
<li><p>[ ] Does it <em>look good</em>? (Do the colors clash? does it look crowded/messy?)</p></li>
</ul>
</div>
___</div>
</div>
<div class="section" id="part-2-clausius-clapeyron-equation-and-the-atmospheric-equation-of-state">
<h2>Part 2: Clausius-Clapeyron Equation and the Atmospheric Equation of State<a class="headerlink" href="#part-2-clausius-clapeyron-equation-and-the-atmospheric-equation-of-state" title="Permalink to this headline">¶</a></h2>
<p>Over large spatial scales in the atmosphere (and ocean) we can attempt to predict the winds (or currents) by looking at spatial changes in the DENSITY. In air the density is a function of pressure, temperature, and the amount of water
vapour present - i.e.  the THERMODYNAMIC STATE*. Moist air is less dense than dry air, because H<span class="math notranslate nohighlight">\(_2\)</span>O gas is lighter than either N<span class="math notranslate nohighlight">\(_2\)</span> or O<span class="math notranslate nohighlight">\(_2\)</span> gas (which makes up most of the atmosphere). We often hear water vapour measurements given as a RELATIVE HUMIDITY (RH) which is the the ratio of the vapor pressure relative to the SATURATION LEVEL for a particular temperature.  The saturation level is the maximum amount of water vapour that air can hold in equilibrium (say, inside a closed bottle containing air and water, which you let sit for a long time).  A RH of 100% means it is foggy (saturated) and 0% means you are coughing and generating sparks every time you walk across a carpet! How do we get from RH to density?</p>
<p>First, define the following quantities:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Symbol</p></th>
<th class="text-align:left head"><p>Variable</p></th>
<th class="text-align:left head"><p>SI Units</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(\rho\)</span></p></td>
<td class="text-align:left"><p>Density</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(kg/m^3\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(P\)</span></p></td>
<td class="text-align:left"><p>Pressure</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(T\)</span></p></td>
<td class="text-align:left"><p>Temperature</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(K\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(RH\)</span></p></td>
<td class="text-align:left"><p>Relative Humidity</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\%\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(r\)</span></p></td>
<td class="text-align:left"><p>Mixing Ratio</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\frac{kg \space water \space vapor}{kg \space dry \space air}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(e\)</span></p></td>
<td class="text-align:left"><p>Vapor Pressure</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(e_s\)</span></p></td>
<td class="text-align:left"><p>Saturation Vapor Pressure</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
</tbody>
</table>
<p>Now,  it  would  be  nice  to  have  (say)  a  single,  perhaps  complicated, equation of state for density (as oceanographers do), but in fact atmospheric scientists define things using a chain of temporary variables†. It all begins with the <em>Clausius-Clapeyron</em> equation which relates the temperature and the saturation vapour pressure:</p>
<div class="math notranslate nohighlight">
\[
e_s = e_0\cdot exp \left[ \frac{L}{R_v}\left(\frac{1}{T_0}-\frac{1}{T}\right)\right]\tag{1}
\]</div>
<p>where <span class="math notranslate nohighlight">\(e_0 = 611Pa\)</span>, <span class="math notranslate nohighlight">\(L= 2.5\cdot10^6J/kg\)</span> is the latent heat of evaporation, <span class="math notranslate nohighlight">\(T_0= 273K\)</span> is a constant (NOT <span class="math notranslate nohighlight">\(273.15K\)</span>), and <span class="math notranslate nohighlight">\(R_v= 461J/K/kg\)</span> (Joules per kelvin per kilogram) is the gas constant for pure water vapour. Next we have</p>
<div class="math notranslate nohighlight">
\[
e = e_s\frac{RH}{100}\tag{2}
\]</div>
<p>and then</p>
<div class="math notranslate nohighlight">
\[
r = \frac{\varepsilon e}{P - e}\tag{3}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\varepsilon= 0.622\frac{kg_{vapour}}{kg_{dry\space air}} \space = \frac{R_d}{R_v}\)</span>, and finally</p>
<div class="math notranslate nohighlight">
\[
\rho = \frac{P}{R_dT(1 + 0.61r)}\tag{4}
\]</div>
<p>where <span class="math notranslate nohighlight">\(R_d = 287J/K/kg\)</span> is  the  ideal  gas  constant  for  dry  air.‡</p>
<p>To  check  units,  remember  that  <span class="math notranslate nohighlight">\(1\space Pa  =1\space kg/m/s^2\)</span>, and <span class="math notranslate nohighlight">\(1\space J=1\space kg m^2/s^2\)</span>.</p>
<hr class="docutils" />
<p>* For oceanographers, density is a function of pressure, temperature, and salinity, and for geologists the density of (say) molten rock will depend on pressure, temperature, and its chemical composition. For this lab you just have to know that there <em>are</em> equations to figure out!</p>
<p>† See <a class="reference external" href="https://www.eoas.ubc.ca/books/Practical_Meteorology/mse3.html">Meteorology Today for Scientists and Engineers, R. Stull</a></p>
<p>‡ You may recognize some similarity between this last equation and the IDEAL GAS LAW <span class="math notranslate nohighlight">\(P V=nRT\)</span> which is no coincidence - in fact the <span class="math notranslate nohighlight">\(0.61r\)</span> is a correction for the non-ideal nature of moist air.</p>
<hr class="docutils" />
<div class="section" id="your-task-implementing-the-clausius-clapeyron-equation-in-python">
<h3>Your Task: Implementing the Clausius-Clapeyron Equation in Python<a class="headerlink" href="#your-task-implementing-the-clausius-clapeyron-equation-in-python" title="Permalink to this headline">¶</a></h3>
<p>Write a code cell which defines variables for all the constants used (i.e. <span class="math notranslate nohighlight">\(L\)</span>, <span class="math notranslate nohighlight">\(R_v\)</span>, <span class="math notranslate nohighlight">\(T_0\)</span>, <span class="math notranslate nohighlight">\(e_0\)</span>) and then find <span class="math notranslate nohighlight">\(e_s\)</span> for a single <span class="math notranslate nohighlight">\(T\)</span>. Be sure to invent good names for all of these symbols and include their units in the comments, e. g. <code class="docutils literal notranslate"><span class="pre">Lvap</span> <span class="pre">=</span> <span class="pre">2.5e6</span>&#160; <span class="pre">#</span> <span class="pre">J/kg</span></code>. Run the cell to find <span class="math notranslate nohighlight">\(e_s\)</span> at a temperature of <span class="math notranslate nohighlight">\(T= 25^oC\)</span>.  Compare this number against a CHECK VALUE 3264.078 Pa. Be careful about operator precedence and make sure you get the correct answer!</p>
<p><strong>Study question</strong> – how would you determine the correct number of significant digits to keep in your answer?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code here  -- make sure  your result has the four letter name --esat-- (case sensitive)</span>
<span class="c1"># also remember to remove the raise NotImplementedError() line when you implement your answer here</span>

<span class="c1">### BEGIN SOLUTION</span>
<span class="c1"># andrew&#39;s soln</span>

<span class="c1"># input</span>
<span class="n">Tc</span> <span class="o">=</span> <span class="mi">25</span>  <span class="c1"># deg C</span>

<span class="c1"># internal definitions</span>
<span class="n">Tk</span> <span class="o">=</span> <span class="n">Tc</span> <span class="o">+</span> <span class="mf">273.15</span>  <span class="c1"># K</span>
<span class="n">e0</span> <span class="o">=</span> <span class="mi">611</span>  <span class="c1"># Pa </span>
<span class="n">Lvap</span> <span class="o">=</span> <span class="mf">2.5e6</span>  <span class="c1"># J/kg</span>
<span class="n">T0</span> <span class="o">=</span> <span class="mi">273</span>  <span class="c1"># K</span>
<span class="n">Rv</span> <span class="o">=</span> <span class="mi">461</span>  <span class="c1"># J/kg/K</span>

<span class="c1"># calculations</span>
<span class="n">esat</span> <span class="o">=</span> <span class="n">e0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">Lvap</span> <span class="o">/</span> <span class="n">Rv</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">T0</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Tk</span><span class="p">))</span>  <span class="c1"># eqn 1</span>

<span class="c1"># outputs</span>
<span class="nb">print</span><span class="p">(</span><span class="n">esat</span><span class="p">)</span>
<span class="c1">### END SOLUTION</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3264.0782439825894
</pre></div>
</div>
</div>
</div>
<p>The cell below shows how we test your answer</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">testing</span><span class="o">.</span><span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">esat</span><span class="p">,</span><span class="mf">3264.078</span><span class="p">,</span><span class="n">decimal</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now add a cell to calculate the air density at  𝑇=25𝑜𝐶,𝑅𝐻=50% , at surface pressure ( 𝑃=102000𝑃𝑎 ). The answer should be (to 7 decimal places) 1.1847106 kg/m 3  (or 1.184704 if  𝜀≡𝑅𝑑/𝑅𝑣 ). Note that increasing the humidity (i.e. adding more water vapour) decreases the density since H 2 O is displacing heavier N 2  and O 2  molecules.</p>
<p><strong>Again, how many significant digits would you trust in this answer?</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove the exception and type your answer here </span>
<span class="c1"># -- name your output variable rho</span>

<span class="c1">### BEGIN SOLUTION</span>
<span class="c1"># andrew&#39;s soln</span>

<span class="c1"># input</span>
<span class="n">RH</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># %</span>
<span class="n">pres</span> <span class="o">=</span> <span class="mi">102000</span>  <span class="c1"># Pa</span>

<span class="c1"># internal definitions (this cell knows about the variables defined in the cell above,</span>
<span class="c1"># so just add the new ones as needed)</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.622</span>  <span class="c1"># vap/air by mass</span>
<span class="n">Rd</span> <span class="o">=</span> <span class="mi">287</span>  <span class="c1"># J/kg/K</span>

<span class="c1"># calculations</span>
<span class="n">e_x</span> <span class="o">=</span> <span class="n">esat</span> <span class="o">*</span> <span class="n">RH</span> <span class="o">/</span> <span class="mi">100</span>  <span class="c1"># eqn 2</span>
<span class="n">mixrat</span> <span class="o">=</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="n">e_x</span> <span class="o">/</span> <span class="p">(</span><span class="n">pres</span> <span class="o">-</span> <span class="n">e_x</span><span class="p">)</span>  <span class="c1"># eqn 3</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">pres</span> <span class="o">/</span> <span class="p">(</span><span class="n">Rd</span> <span class="o">*</span> <span class="n">Tk</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.61</span> <span class="o">*</span> <span class="n">mixrat</span><span class="p">))</span>

<span class="c1"># output</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
<span class="c1">### END SOLUTION</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.1847106098829943
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">testing</span><span class="o">.</span><span class="n">assert_almost_equal</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span><span class="mf">1.1847</span><span class="p">,</span><span class="n">decimal</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Calculate and plot the saturation vapour pressure <span class="math notranslate nohighlight">\(e_s\)</span> for temperatures ranging from -40<span class="math notranslate nohighlight">\(^o\)</span>C to 30<span class="math notranslate nohighlight">\(^o\)</span>C at surface pressure and RH of 50%. Be sure to stick to the format of <em>input, definitions, calulations, output</em>.  Name your
output variable esat</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code</span>

<span class="c1">### BEGIN SOLUTION</span>

<span class="c1"># andrew&#39;s soln</span>

<span class="c1"># input</span>
<span class="n">Tc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>

<span class="c1"># definitions</span>
<span class="n">Tk</span> <span class="o">=</span> <span class="n">Tc</span> <span class="o">+</span> <span class="mf">273.15</span>  <span class="c1"># K</span>

<span class="c1"># calculations</span>
<span class="n">esat</span> <span class="o">=</span> <span class="n">e0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">Lvap</span> <span class="o">/</span> <span class="n">Rv</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">T0</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">Tk</span><span class="p">))</span>  <span class="c1"># eqn 1</span>

<span class="c1"># output </span>
<span class="n">esat</span>
<span class="c1">### END SOLUTION</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([  20.48854285,   22.62832619,   24.97047837,   27.53208041,
         30.33147386,   33.3883396 ,   36.72378062,   40.36040886,
         44.32243633,   48.63577055,   53.32811462,   58.42907186,
         63.97025537,   69.98540253,   76.51049464,   83.58388189,
         91.24641376,   99.54157505,  108.51562768,  118.21775841,
        128.70023275,  140.01855499,  152.23163482,  165.40196042,
        179.59577841,  194.88328068,  211.33879831,  229.04100282,
        248.07311475,  268.52311997,  290.48399362,  314.05393209,
        339.33659306,  366.44134376,  395.48351774,  426.58468019,
        459.87290197,  495.48304264,  533.55704249,  574.24422384,
        617.7016017 ,  664.094204  ,  713.59540146,  766.38724736,
        822.66082726,  882.61661883,  946.46486203, 1014.42593963,
       1086.7307683 , 1163.62120041, 1245.35043657, 1332.18344922,
       1424.39741717, 1522.28217141, 1626.14065214, 1736.28937726,
       1853.05892238, 1976.79441241, 2107.85602491, 2246.61950527,
       2393.47669371, 2548.83606438, 2713.1232765 , 2886.78173759,
       3070.27317907, 3264.07824398, 3468.69708719, 3684.64998796,
       3912.477975  , 4152.74346402, 4406.03090782])
</pre></div>
</div>
</div>
</div>
<p>Next, calculate and plot the mixing ratio <span class="math notranslate nohighlight">\(r\)</span> as a function of temperature for <span class="math notranslate nohighlight">\(RH= 100\%\)</span> and <span class="math notranslate nohighlight">\(P= 90000Pa\)</span>
(about 1 km above the surface).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code here</span>

<span class="c1">### BEGIN SOLUTION</span>
<span class="c1"># andrew&#39;s soln</span>

<span class="c1"># input</span>
<span class="n">RH</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># %</span>
<span class="n">pres</span> <span class="o">=</span> <span class="mi">90000</span>  <span class="c1"># Pa</span>

<span class="c1"># calculations</span>
<span class="n">e_x</span> <span class="o">=</span> <span class="n">esat</span> <span class="o">*</span> <span class="n">RH</span> <span class="o">/</span> <span class="mi">100</span>  <span class="c1"># eqn 2</span>
<span class="n">mixrat</span> <span class="o">=</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="n">e_x</span> <span class="o">/</span> <span class="p">(</span><span class="n">pres</span> <span class="o">-</span> <span class="n">e_x</span><span class="p">)</span>  <span class="c1"># eqn 3</span>

<span class="c1"># output</span>
<span class="n">mixrat</span>
<span class="c1">### END SOLUTION</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.00014163, 0.00015643, 0.00017262, 0.00019034, 0.00020969,
       0.00023084, 0.00025391, 0.00027906, 0.00030647, 0.00033631,
       0.00036878, 0.00040407, 0.00044242, 0.00048405, 0.00052922,
       0.00057819, 0.00063125, 0.0006887 , 0.00075087, 0.00081809,
       0.00089074, 0.00096919, 0.00105387, 0.00114522, 0.00124369,
       0.00134978, 0.00146402, 0.00158697, 0.0017192 , 0.00186135,
       0.00201407, 0.00217806, 0.00235407, 0.00254287, 0.00274529,
       0.00296221, 0.00319456, 0.00344329, 0.00370946, 0.00399415,
       0.00429851, 0.00462375, 0.00497115, 0.00534208, 0.00573795,
       0.00616027, 0.00661064, 0.00709073, 0.00760231, 0.00814725,
       0.00872752, 0.0093452 , 0.01000247, 0.01070167, 0.01144523,
       0.01223574, 0.01307592, 0.01396866, 0.01491699, 0.01592414,
       0.01699351, 0.0181287 , 0.01933352, 0.02061201, 0.02196843,
       0.02340733, 0.02493352, 0.02655208, 0.02826846, 0.0300884 ,
       0.03201804])
</pre></div>
</div>
</div>
</div>
<p>Now, use the <code class="docutils literal notranslate"><span class="pre">plt.subplots</span></code> function to generate a scientific figure as follows:</p>
<ul class="simple">
<li><p>Two plots, the top one showing saturation vapour pressure and the bottom showing mixing ratio as functions of temperature (for <span class="math notranslate nohighlight">\(RH= 100\%\)</span> and <span class="math notranslate nohighlight">\(P= 90000Pa\)</span>).</p></li>
<li><p>“Temperature” on the x axis, in units of <span class="math notranslate nohighlight">\(^o\)</span>C, only labelled once for the whole figure</p></li>
<li><p>Make sure that your figure checks all the boxes for creating a scientific figure</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code</span>

<span class="c1">### BEGIN SOLUTION</span>
<span class="c1"># andrew&#39;s soln</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Saturation Vapour Pressure and Mixing Ratio as Functions of Temperature&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">esat</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Saturation Vapour Pressure (Pa)&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Tc</span><span class="p">,</span> <span class="n">mixrat</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgreen&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Temp ($^o$C)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Mixing Ratio (kg/kg)&quot;</span><span class="p">);</span>
<span class="c1">### END SOLUTION</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lab_wk4_23_0.png" src="../../_images/lab_wk4_23_0.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lab_keys/week4_lab"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="../../wk04/making_plots.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Making Plots Worksheet</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="../../wk05/logic.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Logic</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By UBC<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>
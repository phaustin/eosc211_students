
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lab Week 4 &#8212; EOSC211 - Computer Methods for Earth, Ocean, and Atmospheric Scientists</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Logic" href="../../wk05/logic.html" />
    <link rel="prev" title="Making Plots Worksheet" href="../making_plots.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">EOSC211 - Computer Methods for Earth, Ocean, and Atmospheric Scientists</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../announcements.html">
                    Course Home/Announcements
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 1 - Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus/syllabus.html">
   Course Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus/covid_statements.html">
   Covid Safety in the Classroom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus/schedule_F2021.html">
   Course Schedule - Fall Semester 2021
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus/worksheet_steps_in_problem_solving.html">
   Steps In Problem Solving
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 2 - Data Types
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk02/data_types.html">
   Data Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk02/some_review_plus_built_in_functions_arrays_preview.html">
   Some Review Plus Built-In Functions, Arrays Preview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk02/week2_lab/lab_wk2.html">
   Lab Week 2 - Jupyterhub Tutorial
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk02/week2_quiz.html">
   Week 2 quiz
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 3 - Data Structures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk03/data_structures.html">
   Data Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk03/data_structures_ii.html">
   Data Structures II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk03/week3_quiz.html">
   Week 3 quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk03/week3_lab/lab_wk3.html">
   Lab Week 3
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 4 - Scientific Figures
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../making_plots.html">
   Making Plots Worksheet
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Lab Week 4
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 5 - Computer Logic
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk05/logic.html">
   Logic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk05/complicated_logic.html">
   More Complicated Logic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk05/wk05_indexing.html">
   Indexing worksheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk05/week5_quiz.html">
   Week 5 quiz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk05/week5_lab/lab_wk5.html">
   Lab Week 5
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 6 - Loops
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk06/loops.html">
   Loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk06/loops_ii.html">
   Loops II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk06/week6_quiz.html">
   Q1)  What does the following cell print?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk06/week6_lab/lab_wk6.html">
   Lab Week 6
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 7 - Midterm
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk07/midterm_review.html">
   Midterm Review
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk07/week7_quiz.html">
   Week 7 quiz
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 8 - Functions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk08/functions.html">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk08/functions_ii.html">
   Functions II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk08/quiz_wk08.html">
   Week 08 Quiz: Functions basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk08/week8_lab/lab_wk8.html">
   Lab Week 8
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 9 - Functions/debugging
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk09/debugging.html">
   More Functions &amp; Debugging Practice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk09/quiz_wk9.html">
   Quiz Week 9:  Debugging with Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk09/debugging_ii.html">
   Debugging II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk09/week9_lab/lab_wk9.html">
   Lab Week 9
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 10 - Interpolation/scipy
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk10/wk10_interpolation_demo.html">
   Week 10:  Interpolation - some examples
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk10/dictionaries_and_f_strings.html">
   Dictionaries, F String Literals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk10/quiz_wk10.html">
   Week 10 Quiz
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 11 - Pandas
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk11/pythia_pandas.html">
   Introduction to Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk11/week11_lab/lab_wk11.html">
   Lab Week 11
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk11/wk11_quiz.html">
   Week 11 quiz
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 12 - Review/File IO
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk12/wk12_worksheet1.html">
   Week 12 Review Exercises
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk12/wk12_quiz.html">
   Name / Student #:
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Week 13 - Review
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk13/wk13_worksheet1.html">
   Review Exercises EOSC 211
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk13/wk13_quiz.html">
   Week 13 Quiz 1 Solution:  Review with basic functions, loops, code tracing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk13/wk13_quiz2.html">
   Week 13 Quiz 2:  Review with numpy arrays, basic logical indexing
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../assignment1/assignment1.html">
   Assignment 1 – CO2/temperature
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assignment02/ast2.html">
   Assignment 2 - Flybys
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Extra topics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk12/file_io_practice.html">
   File IO
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk13/e211_colormaps.html">
   Plotting color images with matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk13/next_steps.html">
   Next steps
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference material
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../reference_notes/thursday_oct7.html">
   Notes for Thursday Oct. 7
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk11/week11_lab/pandas-cheatsheet.html">
   Pandas Cheatsheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://phaustin.github.io/eosc211_students/wk11/pythia_pandas.html">
   Pythia Pandas Lesson
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/phaustin/eosc211_students/e211_live_main?urlpath=lab/tree/wk04/week4_lab/lab_wk4.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://open.jupyter.ubc.ca/jupyter/hub/user-redirect/git-pull?repo=https://github.com/phaustin/eosc211_students&urlpath=lab/tree/eosc211_students/wk04/week4_lab/lab_wk4.md&branch=e211_live_main"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/wk04/week4_lab/lab_wk4.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../../_sources/wk04/week4_lab/lab_wk4.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eosc-211">
   EOSC 211
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#learning-objectives">
     Learning Objectives:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-1-computer-math-and-writing-stylish-code-tutorial">
   Part 1: Computer Math and Writing Stylish Code (Tutorial)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tips-on-writing-code-with-style">
     Tips on Writing Code With Style:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coding-up-the-hydrostatic-equations">
     “Coding Up” the Hydrostatic Equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#math-with-arrays">
     Math with Arrays
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-plt-subplots-method">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       plt.subplots()
      </span>
     </code>
     Method
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-2-clausius-clapeyron-equation-and-the-atmospheric-equation-of-state">
   Part 2: Clausius-Clapeyron Equation and the Atmospheric Equation of State
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#your-task-implementing-the-clausius-clapeyron-equation-in-python">
     Your Task: Implementing the Clausius-Clapeyron Equation in Python
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Lab Week 4</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eosc-211">
   EOSC 211
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#learning-objectives">
     Learning Objectives:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-1-computer-math-and-writing-stylish-code-tutorial">
   Part 1: Computer Math and Writing Stylish Code (Tutorial)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tips-on-writing-code-with-style">
     Tips on Writing Code With Style:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#coding-up-the-hydrostatic-equations">
     “Coding Up” the Hydrostatic Equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#math-with-arrays">
     Math with Arrays
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-plt-subplots-method">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       plt.subplots()
      </span>
     </code>
     Method
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#part-2-clausius-clapeyron-equation-and-the-atmospheric-equation-of-state">
   Part 2: Clausius-Clapeyron Equation and the Atmospheric Equation of State
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#your-task-implementing-the-clausius-clapeyron-equation-in-python">
     Your Task: Implementing the Clausius-Clapeyron Equation in Python
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="lab-week-4">
<h1>Lab Week 4<a class="headerlink" href="#lab-week-4" title="Permalink to this headline">#</a></h1>
<div class="section" id="eosc-211">
<h2>EOSC 211<a class="headerlink" href="#eosc-211" title="Permalink to this headline">#</a></h2>
<div class="section" id="learning-objectives">
<h3>Learning Objectives:<a class="headerlink" href="#learning-objectives" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>Do math with python!</p></li>
<li><p>Write structured code following input-process-output procedure</p></li>
<li><p>Develop code with the scaffolding technique</p></li>
<li><p>More plots!</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="part-1-computer-math-and-writing-stylish-code-tutorial">
<h2>Part 1: Computer Math and Writing Stylish Code (Tutorial)<a class="headerlink" href="#part-1-computer-math-and-writing-stylish-code-tutorial" title="Permalink to this headline">#</a></h2>
<p>Below are the hydrostatic equations. They relate <em>atmospheric pressure</em> and <em>density</em> to height above sea level. The pressure and air density conditions we measure at the surface are due to the weight of the atmosphere above being pulled down by Earth’s gravity. As we move higher into the atmosphere, there is less air above us (less weight pushing down), so the pressure decreases, as does the density (less pressure = less force squeezing the air molecules together). For air pressure <span class="math notranslate nohighlight">\(P\)</span>, we can express this as a mathematical function:</p>
<div class="math notranslate nohighlight">
\[
P = P_0\cdot e^{-(a_P/T)\cdot z}\tag{Stull 1.9a†}
\]</div>
<p>similarly for density <span class="math notranslate nohighlight">\(\rho\)</span> (represented by the greek letter <em>rho</em>):</p>
<div class="math notranslate nohighlight">
\[
\rho = \rho_0\cdot e^{-(a_\rho/T)\cdot z}\tag{Stull 1.13a†}
\]</div>
<p>where <span class="math notranslate nohighlight">\(a_P=0.0342 K/m\)</span> and <span class="math notranslate nohighlight">\(a_\rho=0.040K/m\)</span> are constants. The average value for pressure and air density at sea level are <span class="math notranslate nohighlight">\(P_0=101325 Pa\)</span>, and <span class="math notranslate nohighlight">\(\rho_0=1.225kg/m^3\)</span>, respectively.</p>
<p>Lets define our variables in a table:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Symbol</p></th>
<th class="text-align:left head"><p>Variable</p></th>
<th class="text-align:left head"><p>SI Units</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(P\)</span></p></td>
<td class="text-align:left"><p>Pressure</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(\rho\)</span></p></td>
<td class="text-align:left"><p>Density</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(kg/m^3\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(T\)</span></p></td>
<td class="text-align:left"><p>Temperature</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(K\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(z\)</span></p></td>
<td class="text-align:left"><p>Height Above Sea Level</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
</tr>
</tbody>
</table>
<p>We would like to write code to calculate atmospheric pressure and density at any given height. In lecture, we practiced using Python’s built in mathematical operators <code class="docutils literal notranslate"><span class="pre">+</span> <span class="pre">=</span> <span class="pre">*</span> <span class="pre">/</span> <span class="pre">**</span></code>. Now we will apply these skills to <em>mathematically describe the state of the atmosphere</em> and make some informative graphics to communicate our results. As always when tackling a more complex problem, keeping our code organized is incredibly helpful, especially when we need to circle back to either modify or debug our program.</p>
<hr class="docutils" />
<div class="section" id="tips-on-writing-code-with-style">
<h3>Tips on Writing Code With Style:<a class="headerlink" href="#tips-on-writing-code-with-style" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Be very careful with unit conversion.  Humans usually like to express temperature in Celsius, but the thermodynamic equations require temperatures in Kelvin.  That means that you need to distinguish between two temperatures with names like <code class="docutils literal notranslate"><span class="pre">Tk</span></code> and <code class="docutils literal notranslate"><span class="pre">Tc</span></code>, where <code class="docutils literal notranslate"><span class="pre">Tk</span> <span class="pre">=</span> <span class="pre">Tc</span> <span class="pre">+</span> <span class="pre">273.15</span></code>. Make sure that you convert to Kelvin as soon as you can. Do it only once at the start and (if necessary for output) once at the end.</p></li>
<li><p>Choose good variable names. Don’t use single letters like <code class="docutils literal notranslate"><span class="pre">T</span></code> and <code class="docutils literal notranslate"><span class="pre">P</span></code> for variable names in a script. It makes it very hard to do search and replace with your editor when you want to change them, and the names aren’t very meaningful to others who might read your code. Remember that Python is <em>case sensitive</em> so <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">p</span></code> are two different variables. Also, it is super helpful to note the units of each variable with comments.</p></li>
<li><p>As much as you can, separate your script into 4 parts IN THIS ORDER:</p></li>
</ul>
<blockquote>
<div><p><strong>1.  INPUTS:</strong>  These  are  variables  whose  values  you  might  want  to  change  if  you  run  the  program multiple times.</p>
</div></blockquote>
<blockquote>
<div><p><strong>2.  INTERNAL DEFINITIONS or CONSTANTS:</strong> These are variables that are defined as constants which you will never change, or some simple conversions (e.g. Celsius to Kelvin)</p>
</div></blockquote>
<blockquote>
<div><p><strong>3.  CALCULATIONS:</strong> This is where the complicated parts of the procedure go</p>
</div></blockquote>
<blockquote>
<div><p><strong>4.  OUTPUTS:</strong> What you do once the math is finished (e.g. plotting).</p>
</div></blockquote>
<ul class="simple">
<li><p>It is useful to separate the parts by white space, and liberally comment your code. You can also separate each of these four parts into individual cells in a Jupyter Notebook, so you can run them individually, one at a time. Note that not all tasks in 2 and 3 are easily separated, and sometimes plotting happens earlier than the end of the program, but it’s a good idea to always approach problems this way initially.</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="coding-up-the-hydrostatic-equations">
<h3>“Coding Up” the Hydrostatic Equations<a class="headerlink" href="#coding-up-the-hydrostatic-equations" title="Permalink to this headline">#</a></h3>
<p>Write python code to solve for pressure and density:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># inputs</span>
<span class="n">Tc</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># temperature in Celcius [C]</span>
<span class="n">height</span> <span class="o">=</span> <span class="mi">8849</span>  <span class="c1"># [m]</span>

<span class="c1"># internal definitions</span>
<span class="n">Tk</span> <span class="o">=</span> <span class="n">Tc</span> <span class="o">+</span> <span class="mf">273.15</span>  <span class="c1"># temperature in Kelvin [K]</span>
<span class="n">a_P</span> <span class="o">=</span> <span class="mf">0.0342</span>  <span class="c1"># [K/m]</span>
<span class="n">a_rho</span> <span class="o">=</span> <span class="mf">0.040</span>  <span class="c1"># [K/m]</span>
<span class="n">P0</span> <span class="o">=</span> <span class="mi">101325</span>  <span class="c1"># surface pressure in Pascals [Pa]</span>
<span class="n">rho_0</span> <span class="o">=</span> <span class="mf">1.225</span>  <span class="c1"># density at z=0 [kg/m3]</span>

<span class="c1"># calculations</span>
<span class="n">pres</span> <span class="o">=</span> <span class="n">P0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a_P</span> <span class="o">/</span> <span class="n">Tk</span> <span class="o">*</span> <span class="n">height</span><span class="p">)</span>  <span class="c1"># eq 1.9a</span>
<span class="n">dens</span> <span class="o">=</span> <span class="n">rho_0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a_rho</span> <span class="o">/</span> <span class="n">Tk</span> <span class="o">*</span> <span class="n">height</span><span class="p">)</span>  <span class="c1"># eq 1.13a</span>

<span class="c1"># outputs</span>
<span class="c1"># print the result rounded to two decimal places: </span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pressure at </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s1">m is </span><span class="si">{</span><span class="n">pres</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> Pa&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Density is </span><span class="si">{</span><span class="n">dens</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> kg/m3&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pressure at 8849m is 36088.53 Pa
Density is 0.37 kg/m3
</pre></div>
</div>
</div>
</div>
<p>Try playing with the inputs to see if our pressure/density calculator is working properly. We know that at the surface (ie <span class="math notranslate nohighlight">\(z\)</span>=0m), the pressure should equal the reference <span class="math notranslate nohighlight">\(P_0\)</span> of 101325 Pa. On the summit of Mt Everest (8849m), pressure is roughly a third of that value. Waaay up high, (try setting <span class="math notranslate nohighlight">\(z\)</span> to a billion or something) the pressure should drop away to near 0 Pa. Is our calculation working properly? <em>It is <strong>always</strong> good practice to do some “common sense” checks like these wherever you can in writing code - they will save you a lot of time debugging later.</em></p>
</div>
<hr class="docutils" />
<div class="section" id="math-with-arrays">
<h3>Math with Arrays<a class="headerlink" href="#math-with-arrays" title="Permalink to this headline">#</a></h3>
<p>Now that you have working code for <em>scalar inputs</em> (and checked that it calculates the correct values), let’s can apply it to a whole range of values by defining our inputs as numpy arrays instead of single variables (we could also use lists, tuples or most any <em>iterable data type</em> will work). Solving this equation by hand or with a calculator isn’t that hard, but now we can solve it again and again as many times as we want for no extra cost! Let’s compute the pressure for a bunch of different heights, then use Matplotlib to make an XY plot of our output variables over the specified range of inputs.</p>
<p><strong>Remember:</strong> Multiplying an array <code class="docutils literal notranslate"><span class="pre">A</span></code> by a scalar variable <code class="docutils literal notranslate"><span class="pre">b</span></code> multiplies every element of <code class="docutils literal notranslate"><span class="pre">A</span></code> by <code class="docutils literal notranslate"><span class="pre">b</span></code>. Multiplying an array <code class="docutils literal notranslate"><span class="pre">A</span></code> by another array <code class="docutils literal notranslate"><span class="pre">B</span></code> does the operation <em>element-wise</em>; i.e. the first element of <code class="docutils literal notranslate"><span class="pre">A</span></code> gets multiplied by the first element of <code class="docutils literal notranslate"><span class="pre">B</span></code>, the second element of <code class="docutils literal notranslate"><span class="pre">A</span></code> by the second of <code class="docutils literal notranslate"><span class="pre">B</span></code>, etc. This only works if the <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> are the same size and shape.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># change the &quot;height&quot; input to an array</span>
<span class="n">height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># m</span>

<span class="c1"># this cell &quot;knows&quot; about the definitions from the previous cell, no need to repeat</span>
<span class="c1"># (unless we want to change something)</span>

<span class="c1"># calculations</span>
<span class="n">pres</span> <span class="o">=</span> <span class="n">P0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a_P</span> <span class="o">/</span> <span class="n">Tk</span> <span class="o">*</span> <span class="n">height</span><span class="p">)</span>  <span class="c1"># eq 1.9a</span>
<span class="n">dens</span> <span class="o">=</span> <span class="n">rho_0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a_rho</span> <span class="o">/</span> <span class="n">Tk</span> <span class="o">*</span> <span class="n">height</span><span class="p">)</span>  <span class="c1"># eq 1.13a</span>

<span class="c1"># output</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pressure: </span><span class="si">{</span><span class="n">pres</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Density: </span><span class="si">{</span><span class="n">dens</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pressure: [31553.82862659 35458.3495896  39846.02218947 44776.63237856
 50317.36411808 56543.71481951 63540.52406416 71403.12961813
 80238.66649441 90167.52676294]
Density: [0.31300118 0.3587608  0.41121031 0.47132775 0.54023413 0.61921438
 0.70974124 0.8135028  0.93243392 1.06875234]
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="the-plt-subplots-method">
<h3>The <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code> Method<a class="headerlink" href="#the-plt-subplots-method" title="Permalink to this headline">#</a></h3>
<p>The outputs from the previous cell don’t exactly jump off the page. We could show our results much better with, you guessed it: <em>a scientific figure!</em> Unlike last week, we have 2 separate but related datasets, and ideally we would like to present them together as one figure. For this we can use a slightly different plotting syntax, which creates one big “figure” object, and “axes” objects which are displayed on the figure. We can create the axes individually, referencing them using <em>slicing</em> to mess around with their content, labels, colours etc. just like the plot we created last week. The syntax for creating subplots is as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the figure with one row and two columns of plots, and</span>
<span class="c1"># also specify the two subplots to share the same y-axis.</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># use slicing to assign what to plot where</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pres</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dens</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Pressure and Density Variation with Altitude&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>  <span class="c1"># title for the whole figure</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Pressure (Pa)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Height (m)&quot;</span><span class="p">)</span>  <span class="c1"># because sharey=True, we only need this once</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Density (kg/m3)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lab_wk4_8_0.png" src="../../_images/lab_wk4_8_0.png" />
</div>
</div>
<p>Do we check all the boxes?</p>
<div class="alert alert-block alert-info">
<b>Scientific Figure Checklist:</b> 
<ul class="simple">
<li><p>[ ] Title (Short and sweet is best)</p></li>
<li><p>[ ] Axes labels with units (Don’t forget the units!)</p></li>
<li><p>[ ] Legend (Or anything that helps interpret the information presented)</p></li>
<li><p>[ ] Does the figure <em>make sense</em> just by looking at it? The data should be clear without referencing anything outside the figure</p></li>
<li><p>[ ] Does it <em>look good</em>? (Do the colors clash? does it look crowded/messy?)</p></li>
</ul>
</div>
___</div>
</div>
<div class="section" id="part-2-clausius-clapeyron-equation-and-the-atmospheric-equation-of-state">
<h2>Part 2: Clausius-Clapeyron Equation and the Atmospheric Equation of State<a class="headerlink" href="#part-2-clausius-clapeyron-equation-and-the-atmospheric-equation-of-state" title="Permalink to this headline">#</a></h2>
<p>Over large spatial scales in the atmosphere (and ocean) we can attempt to predict the winds (or currents) by looking at spatial changes in the DENSITY. In air the density is a function of pressure, temperature, and the amount of water
vapour present - i.e.  the THERMODYNAMIC STATE*. Moist air is less dense than dry air, because H<span class="math notranslate nohighlight">\(_2\)</span>O gas is lighter than either N<span class="math notranslate nohighlight">\(_2\)</span> or O<span class="math notranslate nohighlight">\(_2\)</span> gas (which makes up most of the atmosphere). We often hear water vapour measurements given as a RELATIVE HUMIDITY (RH) which is the the ratio of the vapor pressure relative to the SATURATION LEVEL for a particular temperature.  The saturation level is the maximum amount of water vapour that air can hold in equilibrium (say, inside a closed bottle containing air and water, which you let sit for a long time).  A RH of 100% means it is foggy (saturated) and 0% means you are coughing and generating sparks every time you walk across a carpet! How do we get from RH to density?</p>
<p>First, define the following quantities:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Symbol</p></th>
<th class="text-align:left head"><p>Variable</p></th>
<th class="text-align:left head"><p>SI Units</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(\rho\)</span></p></td>
<td class="text-align:left"><p>Density</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(kg/m^3\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(P\)</span></p></td>
<td class="text-align:left"><p>Pressure</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(T\)</span></p></td>
<td class="text-align:left"><p>Temperature</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(K\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(RH\)</span></p></td>
<td class="text-align:left"><p>Relative Humidity</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\%\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(r\)</span></p></td>
<td class="text-align:left"><p>Mixing Ratio</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(\frac{kg \space water \space vapor}{kg \space dry \space air}\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(e\)</span></p></td>
<td class="text-align:left"><p>Vapor Pressure</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p><span class="math notranslate nohighlight">\(e_s\)</span></p></td>
<td class="text-align:left"><p>Saturation Vapor Pressure</p></td>
<td class="text-align:left"><p><span class="math notranslate nohighlight">\(Pa\)</span></p></td>
</tr>
</tbody>
</table>
<p>Now,  it  would  be  nice  to  have  (say)  a  single,  perhaps  complicated, equation of state for density (as oceanographers do), but in fact atmospheric scientists define things using a chain of temporary variables†. It all begins with the <em>Clausius-Clapeyron</em> equation which relates the temperature and the saturation vapour pressure:</p>
<div class="math notranslate nohighlight">
\[
e_s = e_0\cdot exp \left[ \frac{L}{R_v}\left(\frac{1}{T_0}-\frac{1}{T}\right)\right]\tag{1}
\]</div>
<p>where <span class="math notranslate nohighlight">\(e_0 = 611Pa\)</span>, <span class="math notranslate nohighlight">\(L= 2.5\cdot10^6J/kg\)</span> is the latent heat of evaporation, <span class="math notranslate nohighlight">\(T_0= 273K\)</span> is a constant (NOT <span class="math notranslate nohighlight">\(273.15K\)</span>), and <span class="math notranslate nohighlight">\(R_v= 461J/K/kg\)</span> (Joules per kelvin per kilogram) is the gas constant for pure water vapour. Next we have</p>
<div class="math notranslate nohighlight">
\[
e = e_s\frac{RH}{100}\tag{2}
\]</div>
<p>and then</p>
<div class="math notranslate nohighlight">
\[
r = \frac{\varepsilon e}{P - e}\tag{3}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\varepsilon= 0.622\frac{kg_{vapour}}{kg_{dry\space air}} \space = \frac{R_d}{R_v}\)</span>, and finally</p>
<div class="math notranslate nohighlight">
\[
\rho = \frac{P}{R_dT(1 + 0.61r)}\tag{4}
\]</div>
<p>where <span class="math notranslate nohighlight">\(R_d = 287J/K/kg\)</span> is  the  ideal  gas  constant  for  dry  air.‡</p>
<p>To  check  units,  remember  that  <span class="math notranslate nohighlight">\(1\space Pa  =1\space kg/m/s^2\)</span>, and <span class="math notranslate nohighlight">\(1\space J=1\space kg m^2/s^2\)</span>.</p>
<hr class="docutils" />
<p>* For oceanographers, density is a function of pressure, temperature, and salinity, and for geologists the density of (say) molten rock will depend on pressure, temperature, and its chemical composition. For this lab you just have to know that there <em>are</em> equations to figure out!</p>
<p>† See <a class="reference external" href="https://www.eoas.ubc.ca/books/Practical_Meteorology/mse3.html">Meteorology Today for Scientists and Engineers, R. Stull</a></p>
<p>‡ You may recognize some similarity between this last equation and the IDEAL GAS LAW <span class="math notranslate nohighlight">\(P V=nRT\)</span> which is no coincidence - in fact the <span class="math notranslate nohighlight">\(0.61r\)</span> is a correction for the non-ideal nature of moist air.</p>
<hr class="docutils" />
<div class="section" id="your-task-implementing-the-clausius-clapeyron-equation-in-python">
<h3>Your Task: Implementing the Clausius-Clapeyron Equation in Python<a class="headerlink" href="#your-task-implementing-the-clausius-clapeyron-equation-in-python" title="Permalink to this headline">#</a></h3>
<p>Write a code cell which defines variables for all the constants used (i.e. <span class="math notranslate nohighlight">\(L\)</span>, <span class="math notranslate nohighlight">\(R_v\)</span>, <span class="math notranslate nohighlight">\(T_0\)</span>, <span class="math notranslate nohighlight">\(e_0\)</span>) and then find <span class="math notranslate nohighlight">\(e_s\)</span> for a single <span class="math notranslate nohighlight">\(T\)</span>. Be sure to invent good names for all of these symbols and include their units in the comments, e. g. <code class="docutils literal notranslate"><span class="pre">Lvap</span> <span class="pre">=</span> <span class="pre">2.5e6</span>&#160; <span class="pre">#</span> <span class="pre">J/kg</span></code>. Run the cell to find <span class="math notranslate nohighlight">\(e_s\)</span> at a temperature of <span class="math notranslate nohighlight">\(T= 25^oC\)</span>.  Compare this number against a CHECK VALUE 3264.0782439825894 Pa. Be careful about operator precedence and make sure you get the correct answer!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code</span>
</pre></div>
</div>
</div>
</div>
<p>Now add a cell to  calculate  the  air  density  at <span class="math notranslate nohighlight">\(T= 25^oC,RH= 50\%\)</span>,  at  surface  pressure  (<span class="math notranslate nohighlight">\(P= 102000Pa\)</span>).   The  answer  should  be  1.1847106098829943 kg/m<span class="math notranslate nohighlight">\(^3\)</span> if you used <span class="math notranslate nohighlight">\(\varepsilon = 0.622\)</span> (or  1.184704073721439  if you used <span class="math notranslate nohighlight">\(\varepsilon≡R_d/R_v\)</span>).   Note  that  increasing  the  humidity  (i.e.   adding  more  water  vapour)  decreases  the  density since H<span class="math notranslate nohighlight">\(_2\)</span>O is displacing heavier N<span class="math notranslate nohighlight">\(_2\)</span> and O<span class="math notranslate nohighlight">\(_2\)</span> molecules.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code</span>
</pre></div>
</div>
</div>
</div>
<p>Calculate the saturation vapour pressure <span class="math notranslate nohighlight">\(e_s\)</span> for temperatures ranging from -40<span class="math notranslate nohighlight">\(^o\)</span>C to 30<span class="math notranslate nohighlight">\(^o\)</span>C at surface pressure and RH of 50%. Be sure to stick to the format of <em>input, definitions, calulations, output</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code</span>
</pre></div>
</div>
</div>
</div>
<p>Next, calculate and plot the mixing ratio <span class="math notranslate nohighlight">\(r\)</span> as a function of temperature for <span class="math notranslate nohighlight">\(RH= 100\%\)</span> and <span class="math notranslate nohighlight">\(P= 90000Pa\)</span> (about 1 km above the surface).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code</span>
</pre></div>
</div>
</div>
</div>
<p>Now, use the <code class="docutils literal notranslate"><span class="pre">plt.subplots</span></code> function to generate a scientific figure as follows:</p>
<ul class="simple">
<li><p>Two plots, the top one showing saturation vapour pressure and the bottom showing mixing ratio as functions of temperature (for <span class="math notranslate nohighlight">\(RH= 100\%\)</span> and <span class="math notranslate nohighlight">\(P= 90000Pa\)</span>).</p></li>
<li><p>“Temperature” on the x axis, in units of <span class="math notranslate nohighlight">\(^o\)</span>C, only labelled once for the whole figure</p></li>
<li><p>Make sure that your figure checks all the boxes for creating a scientific figure</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># your code</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./wk04/week4_lab"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../making_plots.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Making Plots Worksheet</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../../wk05/logic.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Logic</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By UBC<br/>
  
      &copy; Copyright 2021.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lab Week 11 &#8212; EOSC211 - Computer Methods for Earth, Ocean, and Atmospheric Scientists</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Practice with loops, if, strings, file IO, logical indexing" href="../../wk12/file_io_practice.html" />
    <link rel="prev" title="Dictionaries, F String Literals" href="../../wk10/dictionaries_and_f_strings.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      <h1 class="site-logo" id="site-title">EOSC211 - Computer Methods for Earth, Ocean, and Atmospheric Scientists</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../announcements.html">
   Course Home/Announcements
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 1 - Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus/syllabus.html">
   Course Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus/covid_statements.html">
   Covid Safety in the Classroom
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus/schedule_F2021.html">
   Course Schedule - Fall Semester 2021
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../syllabus/worksheet_steps_in_problem_solving.html">
   Steps In Problem Solving
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 2 - Data Types
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk02/data_types.html">
   Data Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk02/some_review_plus_built_in_functions_arrays_preview.html">
   Some Review Plus Built-In Functions, Arrays Preview
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 3 - Data Structures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk03/data_structures.html">
   Data Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk03/data_structures_ii.html">
   Data Structures II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../exchange/e211/outbound/week3_lab/lab_wk3.html">
   Lab Week 3
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 4 - Scientific Figures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk04/making_plots.html">
   Making Plots
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk04/lab_wk4/lab_wk4.html">
   Lab Week 4
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 5 - Computer Logic
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk05/logic.html">
   Logic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk05/complicated_logic.html">
   More Complicated Logic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk05/lab_wk5/lab_wk5.html">
   Lab Week 5
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Assignment 1
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../assignment01/ast1.html">
   Assignment 1
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 6 - Loops
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk06/loops.html">
   Loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk06/loops_ii.html">
   Loops II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk06/lab_wk6/lab_wk6.html">
   Lab Week 6
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 8 - Functions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk08/functions.html">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk08/functions_ii.html">
   Functions II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk08/lab_wk8/lab_wk8.html">
   Lab Week 8
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 9 - Debugging
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk09/debugging.html">
   Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk09/debugging_2.html">
   Debugging II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk09/lab_wk9/lab_wk9.html">
   Lab Week 9
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 10 - Developing Workflows
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk10/dictionaries_and_f_strings.html">
   Dictionaries, F String Literals
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 11 - Vectorization and Speed
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Lab Week 11
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 12
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk12/file_io_practice.html">
   Practice with loops, if, strings,  file IO, logical indexing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../wk12/exercises.html">
   Exercises
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/wk11/lab_wk11/lab_wk11.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eosc-211">
   EOSC 211
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#learning-objectives">
     Learning Objectives:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#intro">
     Intro
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <!-- #region -->
<div class="section" id="lab-week-11">
<h1>Lab Week 11<a class="headerlink" href="#lab-week-11" title="Permalink to this headline">¶</a></h1>
<div class="section" id="eosc-211">
<h2>EOSC 211<a class="headerlink" href="#eosc-211" title="Permalink to this headline">¶</a></h2>
<div class="section" id="learning-objectives">
<h3>Learning Objectives:<a class="headerlink" href="#learning-objectives" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Interpolate data</p></li>
<li><p>Learn something cool about coastal upwelling and salitity/density gradients</p></li>
</ol>
</div>
<div class="section" id="intro">
<h3>Intro<a class="headerlink" href="#intro" title="Permalink to this headline">¶</a></h3>
<p>During coastal upwelling, dense deep water is brought up over the shelf-break onto the shallow shelf. In theory, we
then see horizontal gradients of density - at the same depth, water is heavier inshore. Heavier water is usually more
saline, so we also see saltier water inshore. In this lab we are going to examine some salinity data from sections
south-west of Vancouver Island. Ultimately, we want to answer the question: Is water more saline on the shelf at
this time? There are two steps to this process:</p>
<ul class="simple">
<li><p>Interpolate data along oceanographic sections to a common distance from the shelf edge.</p></li>
<li><p>Compare the mean profiles at a distance of 0 and 20 km from the shelf edge to see if they are statistically different.</p></li>
</ul>
<!-- #endregion -->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">e211_lib</span> <span class="kn">import</span> <span class="n">e211</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span> <span class="k">as</span> <span class="n">itp</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the raw data</span>
<span class="n">shiptrack_raw</span> <span class="o">=</span> <span class="n">e211</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s2">&quot;lab_11_data.mat&quot;</span><span class="p">)</span>  <span class="c1"># track and data from the FK009A cruise</span>
<span class="n">southVI_raw</span> <span class="o">=</span> <span class="n">e211</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s2">&quot;SouthVI.mat&quot;</span><span class="p">)</span>  <span class="c1"># bathymetry of south vancouver island</span>

<span class="n">shiptrack_raw</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># do some data scrubbing, repackage into straightforward dictionaries</span>
<span class="n">southVI</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="n">southVI_raw</span><span class="p">[</span><span class="s2">&quot;SouthVI&quot;</span><span class="p">][</span><span class="s2">&quot;lon&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
    <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="n">southVI_raw</span><span class="p">[</span><span class="s2">&quot;SouthVI&quot;</span><span class="p">][</span><span class="s2">&quot;lat&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
    <span class="s2">&quot;depth&quot;</span><span class="p">:</span> <span class="n">southVI_raw</span><span class="p">[</span><span class="s2">&quot;SouthVI&quot;</span><span class="p">][</span><span class="s2">&quot;depth&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">shiptrack</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;depths&quot;</span><span class="p">:</span> <span class="n">shiptrack_raw</span><span class="p">[</span><span class="s2">&quot;depths&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
    <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="n">shiptrack_raw</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
    <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="n">shiptrack_raw</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
    <span class="s2">&quot;lat200&quot;</span><span class="p">:</span> <span class="n">shiptrack_raw</span><span class="p">[</span><span class="s2">&quot;lat200&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
    <span class="s2">&quot;lon200&quot;</span><span class="p">:</span> <span class="n">shiptrack_raw</span><span class="p">[</span><span class="s2">&quot;lon200&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
    <span class="s2">&quot;saln&quot;</span><span class="p">:</span> <span class="n">shiptrack_raw</span><span class="p">[</span><span class="s2">&quot;saln&quot;</span><span class="p">],</span>
    <span class="s2">&quot;tempr&quot;</span><span class="p">:</span> <span class="n">shiptrack_raw</span><span class="p">[</span><span class="s2">&quot;tempr&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">## we could recycle the mean2d function from week 9 to smooth the data before plotting</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># make some plots to show the problem statement</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="c1"># mask the depth array, taking all land (i.e. depth &gt; 0) elements to nan</span>
<span class="n">southVI</span><span class="p">[</span><span class="s2">&quot;depth&quot;</span><span class="p">][</span><span class="n">southVI</span><span class="p">[</span><span class="s2">&quot;depth&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="c1"># create 200 meter contours, spanning the whole range of depths</span>
<span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="n">cont</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">southVI</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">],</span> <span class="n">southVI</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">],</span> <span class="n">southVI</span><span class="p">[</span><span class="s2">&quot;depth&quot;</span><span class="p">],</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;GnBu_r&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shiptrack</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">],</span> <span class="n">shiptrack</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shiptrack</span><span class="p">[</span><span class="s2">&quot;lon200&quot;</span><span class="p">],</span> <span class="n">shiptrack</span><span class="p">[</span><span class="s2">&quot;lat200&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Ship&#39;s Track for the FK009A Cruise&quot;</span><span class="p">)</span>

<span class="n">sal</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">shiptrack</span><span class="p">[</span><span class="s2">&quot;saln&quot;</span><span class="p">],</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;upper&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;winter&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;FK009A Measurements, Salinity as a Function of Depth&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Elevation/Depth (m)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sal</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Salinity (parts per 1000 NaCl)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The ship’s track over the shelf is shown on the left, and the corresponding profiles of salinity as functions of depth. We would like to know about the salinity profiles in relation to the shelf rather than the somewhat arbitrary ship track. To do this, we will need to use <em>interpolation</em> to compensate for ship’s data being unevenly spaced and not perfectly lining up with the map grid spacing.</p>
<p>First, define a function that calculates the distance between the ship’s path and the track. Mathematically, we write  the distance between two points as</p>
<div class="math notranslate nohighlight">
\[
d = \sqrt{\Delta x^2 + \Delta y^2}
\]</div>
<p>To convert from degrees to kilometers, use:</p>
<div class="math notranslate nohighlight">
\[
\Delta x = \Delta lon \times 111 \times cos(lat)
\]</div>
<div class="math notranslate nohighlight">
\[
\Delta y = \Delta lat \times 111
\]</div>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">shortest_dist()</span></code> that takes in the ship track and shelf coordinates (the 200m depth contour line), and returns a 1D array containing the shortest distance from the each point along the ship track to the shelf. Make sure to include a docstring, and that your cosine function is in degrees, not radians</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># andrew&#39;s soln</span>
<span class="k">def</span> <span class="nf">shortest_dist</span><span class="p">(</span><span class="n">pathlon</span><span class="p">,</span> <span class="n">pathlat</span><span class="p">,</span> <span class="n">linelon</span><span class="p">,</span> <span class="n">linelat</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds shortest distance from a point to a line.</span>
<span class="sd">    Loops through each element in LAT and LON and finds the minimum</span>
<span class="sd">    distance from that point to the line given by &#39;linelat&#39; and</span>
<span class="sd">    &#39;linelon&#39;. For example, if &#39;linelon&#39; and &#39;linelat&#39; specify the</span>
<span class="sd">    200 m contour, it returns a new array containing the shortest distance</span>
<span class="sd">    from each point given by lon and lat to that contour.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">pathlon</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pathlon</span><span class="p">)):</span>
        <span class="c1"># convert to km and find the shortest path from each point in</span>
        <span class="c1"># path to line. save each shortest distance in dist</span>
        <span class="n">deltax</span> <span class="o">=</span> <span class="p">(</span><span class="n">pathlon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">linelon</span><span class="p">)</span> <span class="o">*</span> <span class="mf">111.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">pathlat</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="n">deltay</span> <span class="o">=</span> <span class="p">(</span><span class="n">pathlat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">linelat</span><span class="p">)</span> <span class="o">*</span> <span class="mf">111.0</span>
        <span class="n">s_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">((</span><span class="n">deltax</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">deltay</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">s_dist</span>
        
        <span class="c1"># If the point is to the LEFT of the 200 m contour, write the</span>
        <span class="c1"># distance as a negative value</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pathlat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">linelat</span><span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pathlon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">linelon</span><span class="p">[</span><span class="n">ind</span><span class="p">]:</span>
            <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">dist</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># test the function by visiualizing results. do they make sense? (yes)</span>
<span class="n">shiptrack</span><span class="p">[</span><span class="s2">&quot;dist_from_shelf&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shortest_dist</span><span class="p">(</span>
    <span class="n">shiptrack</span><span class="p">[</span><span class="s2">&quot;lon&quot;</span><span class="p">],</span> <span class="n">shiptrack</span><span class="p">[</span><span class="s2">&quot;lat&quot;</span><span class="p">],</span> <span class="n">shiptrack</span><span class="p">[</span><span class="s2">&quot;lon200&quot;</span><span class="p">],</span> <span class="n">shiptrack</span><span class="p">[</span><span class="s2">&quot;lat200&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shiptrack</span><span class="p">[</span><span class="s2">&quot;dist_from_shelf&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Now that we have an array describing the ship’s position in relation to the shelf, let’s plot our data again, but this time with distance from shelf on the x axis and depth on the y axis:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">cont</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">shiptrack</span><span class="p">[</span><span class="s2">&quot;dist_from_shelf&quot;</span><span class="p">],</span> <span class="n">shiptrack</span><span class="p">[</span><span class="s2">&quot;depths&quot;</span><span class="p">],</span> <span class="n">shiptrack</span><span class="p">[</span><span class="s2">&quot;saln&quot;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;winter&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Distance from shelf (km)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Depth (m)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cont</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Salinity (parts per 1000 NaCl)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can start to see the horizontal salinity gradient we originally hypothesized, but there are obvious gaps and overlaps in the data. Ideally, we would like an evenly spaced grid with no missing (NaN) values. To do this, we need to interpolate. Check out the docs for the following scipy interpolation functions</p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.NearestNDInterpolator.html">nearest neighbour</a></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.interpolate.interp2d.html">polynomial</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./wk11/lab_wk11"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="../../wk10/dictionaries_and_f_strings.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Dictionaries, F String Literals</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="../../wk12/file_io_practice.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Practice with loops, if, strings,  file IO, logical indexing</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By UBC<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>